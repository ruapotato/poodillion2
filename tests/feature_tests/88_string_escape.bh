# Test string escape handling
try:
    from typing import List
except:
    pass

TT_STRING: int = 61

class Token:
    def __init__(self, ttype: int, value: str, line: int, column: int):
        self.ttype: int = ttype
        self.value: str = value
        self.line: int = line
        self.column: int = column

class Lexer:
    def __init__(self, source: str):
        self.source: str = source
        self.pos: int = 0
        self.line: int = 1
        self.column: int = 1

    def at_end(self) -> bool:
        return self.pos >= len(self.source)

    def current_char(self) -> char:
        return self.source[self.pos]

    def advance(self):
        if self.pos < len(self.source):
            ch: char = self.source[self.pos]
            if ch == '\n':
                self.line = self.line + 1
                self.column = 1
            else:
                self.column = self.column + 1
            self.pos = self.pos + 1

    def read_string(self) -> Token:
        start_line: int = self.line
        start_col: int = self.column
        quote: char = self.current_char()
        self.advance()

        string: str = ""
        while True:
            if self.at_end():
                break
            ch: char = self.current_char()
            if ch == quote:
                self.advance()
                break
            if ch == '\\':
                self.advance()
                esc: char = self.current_char()
                if esc == 'n':
                    string = string + '\n'
                elif esc == 't':
                    string = string + '\t'
                else:
                    string = string + esc
                self.advance()
            else:
                string = string + ch
                self.advance()

        return Token(TT_STRING, string, start_line, start_col)

def main() -> int:
    # Test simple string without escapes
    code: str = "\"hello\""
    lexer: Lexer = Lexer(code)
    tok: Token = lexer.read_string()
    # "hello" has 5 chars inside quotes
    n: int = len(tok.value)
    if n == 5:
        print("OK\n")
    else:
        print("FAIL: len=")
        if n < 10:
            c: char = chr(48 + n)
            print(c)
        else:
            c1: char = chr(48 + n // 10)
            c2: char = chr(48 + n % 10)
            print(c1)
            print(c2)
        print("\n")
    return 0
