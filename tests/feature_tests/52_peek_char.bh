# Test 52: peek_char pattern (lookahead without advancing)
class Reader:
    def __init__(self, text: str):
        self.source: str = text
        self.pos: int = 0

    def at_end(self) -> bool:
        n: int = len(self.source)
        return self.pos >= n

    def current_char(self) -> char:
        return self.source[self.pos]

    def peek_char(self) -> char:
        next_pos: int = self.pos + 1
        n: int = len(self.source)
        if next_pos < n:
            return self.source[next_pos]
        return '\0'

    def advance(self):
        self.pos = self.pos + 1

def main() -> int:
    print("Peek char test\n")

    r: Reader = Reader("ab")

    # Current should be 'a'
    ch: char = r.current_char()
    if ch == 'a':
        print("Curr a: OK\n")
    else:
        print("Curr a: FAIL\n")

    # Peek should be 'b'
    pk: char = r.peek_char()
    if pk == 'b':
        print("Peek b: OK\n")
    else:
        print("Peek b: FAIL\n")

    # Advance
    r.advance()

    # Current should be 'b'
    ch = r.current_char()
    if ch == 'b':
        print("Curr b: OK\n")
    else:
        print("Curr b: FAIL\n")

    # Peek should be '\0' at end
    pk = r.peek_char()
    if pk == '\0':
        print("Peek end: OK\n")
    else:
        print("Peek end: FAIL\n")

    print("Done\n")
    return 0
