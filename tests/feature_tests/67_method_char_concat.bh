# Test 67: Char concatenation in method reading from field
try:
    from typing import List
except:
    pass

class Token:
    def __init__(self, value: str):
        self.value: str = value

class Reader:
    def __init__(self, s: str):
        self.source: str = s
        self.pos: int = 0
        self.tokens: List[Token] = []

    def at_end(self) -> bool:
        return self.pos >= len(self.source)

    def current(self) -> char:
        return self.source[self.pos]

    def advance(self):
        self.pos = self.pos + 1

    def read_word(self) -> str:
        result: str = ""
        while not self.at_end():
            ch: char = self.current()
            # Check if alphanumeric
            c: int = ord(ch)
            is_alnum: bool = (c >= 97 and c <= 122)
            if is_alnum:
                result = result + ch
                self.advance()
            else:
                break
        return result

    def tokenize(self):
        while not self.at_end():
            ch: char = self.current()
            # Skip space
            if ch == ' ':
                self.advance()
                continue
            # Read word
            c: int = ord(ch)
            if c >= 97 and c <= 122:
                word: str = self.read_word()
                tok: Token = Token(word)
                self.tokens.append(tok)
                continue
            self.advance()

def main() -> int:
    print("Method char concat test\n")

    r: Reader = Reader("abc def")
    r.tokenize()
    print("Tokenized\n")

    # Retrieve and compare
    n: int = len(r.tokens)
    if n == 2:
        print("Count: OK\n")
    else:
        print("Count: FAIL\n")

    print("Accessing first token...\n")
    first: Token = r.tokens[0]
    print("Got first token\n")
    v1: str = first.value
    print("Got first value\n")
    if v1 == "abc":
        print("Token 1: OK\n")
    else:
        print("Token 1: FAIL\n")

    print("Done\n")
    return 0
